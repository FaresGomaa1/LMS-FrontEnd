<div class="container-fluid col-6">
    <form [formGroup]="ExamForm" (submit)="onSubmit($event)" class="mt-5 border p-5">
        <div class="form-group">
            <label for="examName">Exam Name</label>
            <span class="p-float-label">
                <input pInputText type="text" id="examName" formControlName="name" class="form-control"
                    placeholder="Enter exam name" required [ngClass]="{
                  'is-valid': nameControl.valid,
                  'is-invalid': nameControl.invalid && nameControl.touched
                }" />
                <div class="invalid-feedback error-message" *ngIf="nameControl.errors && nameControl.touched">
                    <ng-container *ngIf="nameControl.hasError('required')">Exam name is required</ng-container>
                    <ng-container *ngIf="nameControl.hasError('minlength')">Exam name is too long</ng-container>
                </div>
            </span>
        </div>

        <div class="form-group">
            <h3>Enter Time</h3>
            <input type="time" formControlName="time" class="form-control"
                placeholder="Enter exam time" required [ngClass]="{
                  'is-valid': timeControl.valid,
                  'is-invalid': timeControl.invalid && timeControl.touched
                }" />
            <div class="invalid-feedback error-message" *ngIf="timeControl.errors && timeControl.touched">
                <ng-container *ngIf="timeControl.hasError('required')">Time is required</ng-container>
            </div>
        </div>

        <div class="form-group">
            <label for="examDuration">Duration (in minutes)</label>
            <input pInputText type="number" id="examDuration" formControlName="duration" class="form-control"
                placeholder="Enter exam duration" required [ngClass]="{
                'is-valid': durationControl.valid,
                'is-invalid': durationControl.invalid && durationControl.touched
              }" />
            <div class="invalid-feedback error-message" *ngIf="durationControl.errors && durationControl.touched">
                <ng-container *ngIf="durationControl.hasError('required')">Duration is required</ng-container>
                <ng-container *ngIf="durationControl.hasError('min')">Duration must be more than 0</ng-container>
            </div>
        </div>

        <div class="form-group">
            <label for="examDate">Exam Date</label>
            <input pInputText type="date" id="examDate" formControlName="date" class="form-control"
                placeholder="Select exam date" required [ngClass]="{
                'is-valid': dateControl.valid,
                'is-invalid': dateControl.invalid && dateControl.touched
              }" />
            <div class="invalid-feedback error-message" *ngIf="dateControl.errors && dateControl.touched">
                <ng-container *ngIf="dateControl.hasError('required')">Exam date is required</ng-container>
                <ng-container *ngIf="dateControl.hasError('past')">Start date must be after today.</ng-container>
            </div>
        </div>

        <div class="form-group">
            <label for="examMaxDegree">Max Degree</label>
            <input pInputText type="number" id="examMaxDegree" formControlName="max_Degree" class="form-control"
                placeholder="Enter max degree" required [ngClass]="{
                'is-valid': maxControl.valid,
                'is-invalid': maxControl.invalid && maxControl.touched
              }" />
            <div class="invalid-feedback error-message" *ngIf="maxControl.errors && maxControl.touched">
                <ng-container *ngIf="maxControl.hasError('required')">Max degree is required</ng-container>
                <ng-container *ngIf="maxControl.hasError('minGreaterThanMax')">Max degree must be greater than min degree</ng-container>
            </div>
        </div>

        <div class="form-group">
            <label for="examMinDegree">Min Degree</label>
            <input pInputText type="number" id="examMinDegree" formControlName="min_Degree" class="form-control"
                placeholder="Enter min degree" required [ngClass]="{
                'is-valid': minControl.valid,
                'is-invalid': minControl.invalid && minControl.touched
              }" />
            <div class="invalid-feedback error-message" *ngIf="minControl.errors && minControl.touched">
                <ng-container *ngIf="minControl.hasError('required')">Min degree is required</ng-container>
                <ng-container *ngIf="minControl.hasError('minGreaterThanMax')">Min degree must be less than max degree</ng-container>
            </div>
        </div>

        <div *ngIf="questions">
            <div *ngFor="let questionGroup of questions.controls; let i = index" [formGroupName]="i"
                class="question-container">
                <div class="form-group">
                    <label for="question{{i}}">Question {{i + 1}}</label>
                    <input pInputText type="text" id="question{{i}}" formControlName="question" class="form-control"
                        placeholder="Enter question" required />
                </div>
                <div class="form-group">
                    <label for="questionType{{i}}">Question Type</label>
                    <select pInputText id="questionType{{i}}" formControlName="questionType" class="form-control">
                        <option value="MCQ">MCQ</option>
                        <option value="TrueOrFalse">True Or False</option>
                   
                    </select>
                </div>
                <div class="mb-3">
                    <label for="correctAnswer" class="form-label">Correct Answer</label>
                    <input type="text" class="form-control" id="correctAnswer" formControlName="correctAnswer"
                        required [ngClass]="{
                        'is-valid': ExamForm.get('correctAnswer')?.valid,
                        'is-invalid': ExamForm.get('correctAnswer')?.invalid && ExamForm.get('correctAnswer')?.touched
                    }">
                    <div class="invalid-feedback error-message" *ngIf="ExamForm.get('correctAnswer')?.errors && ExamForm.get('correctAnswer')?.touched">
                        <ng-container *ngIf="ExamForm.get('correctAnswer')?.hasError('required')">Correct Answer is required</ng-container>
                    </div>
                    <div *ngIf="ExamForm.get('correctAnswer')?.hasError('incorrectAnswer')" class="invalid-feedback error-message">
                        Please select a correct answer from the provided choices.
                    </div>
                </div>
                

                <div class="mb-3">
                    <label class="form-label">Choices</label>
                    <div class="form-check" *ngFor="let j of [0, 1, 2, 3]; let index = index">
                        <div class="input-group mb-3">
                            <input type="text" class="form-control" [id]="'choiceText' + j"
                                [placeholder]="'Choice ' + (index + 1)" [formControl]="getChoiceControl(i)"
                                formControlName="choices" [required]="index < 2"
                                [ngClass]="{
                             'is-valid': getChoiceControl(i).valid,
                             'is-invalid': getChoiceControl(i).invalid && getChoiceControl(i).touched
                           }">
                            <div class="invalid-feedback error-message"
                                *ngIf="getChoiceControl(i).invalid && getChoiceControl(i).touched">
                                Please provide a choice.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <button type="button" class="btn btn-primary" (click)="addQuestion()">Add Question</button>

        <button type="submit" class="btn btn-primary">Submit</button>
    </form>
</div>
